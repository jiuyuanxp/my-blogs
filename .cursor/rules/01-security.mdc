---
description: 强制性安全检查 - 提交前必过
alwaysApply: true
---

# 安全规范

## 提交前检查清单

- [ ] 无硬编码密钥（API keys、密码、token）
- [ ] 所有用户输入已校验
- [ ] SQL 注入防护（参数化查询）
- [ ] XSS 防护（HTML 转义/净化）
- [ ] CSRF 保护已启用
- [ ] 认证/授权已验证
- [ ] 所有端点有速率限制
- [ ] 错误信息不泄露敏感数据

## 密钥管理

- 绝不在源码中硬编码密钥
- 使用环境变量或密钥管理服务
- 启动时校验必需密钥是否存在
- 若密钥可能泄露，立即轮换

## 发现安全问题时的流程

1. 立即停止
2. 使用 security-reviewer 或安全相关 skill
3. 修复 CRITICAL 后再继续
4. 轮换已泄露密钥
5. 全库排查同类问题

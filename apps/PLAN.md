# Apps 项目规划

> 本文档用于规划 `apps/` 目录下应用的开发路线，随讨论持续完善。

## 1. 项目概述

### 1.1 定位

`apps/` 为 Monorepo 的**应用层**，承载面向用户的前端应用。当前以 `web`（主站）为主，未来可扩展管理后台、移动端 H5 等。

### 1.2 当前应用

| 应用    | 技术栈                    | 说明                               |
| ------- | ------------------------- | ---------------------------------- |
| `web`   | Next.js 16 + TypeScript   | 主站前端，博客展示、SEO 优化       |
| `admin` | React + Vite + TypeScript | 管理后台，Markdown 编辑、文章 CRUD |

### 1.3 开发策略

- **先完成再学**：AI 辅助实现功能，完成后回头研读代码、写学习笔记
- **技能现状**：前端熟悉；Java 后端、Next.js 待学习
- **Admin 选型**：使用 React（非 Next.js），发挥前端优势，降低学习负担

### 1.4 目标用户

- **读者**：浏览文章、搜索、订阅
- **作者**（未来）：撰写、发布、管理文章

---

## 2. 当前状态

### 2.1 已完成

- [x] Next.js 16 初始化（App Router、Turbopack）
- [x] 国际化（next-intl，中/英）
- [x] SEO 基础（Sitemap、Robots.txt、Open Graph、JSON-LD）
- [x] 首页布局（欢迎语、示例文章卡片、关于我）
- [x] 暗色模式支持（Tailwind dark:）
- [x] 语言切换组件

### 2.2 待完成

- [ ] 文章列表页（对接 Java 后端 `/api/articles`）
- [ ] 文章详情页（`/articles/[id]`）
- [ ] 分页 / 无限滚动
- [ ] 搜索功能
- [ ] 单元测试 & E2E 测试
- [ ] middleware 迁移至 proxy（Next.js 16 弃用提示）

### 2.3 已知问题

- [ ] `middleware` 文件约定已弃用，需迁移至 `proxy`
- [ ] 首页文章为静态 i18n 文案，未对接真实 API

---

## 3. 功能规划

### 3.1 阶段一：核心阅读体验（优先）

| 功能         | 说明                                  | 依赖     | 优先级 |
| ------------ | ------------------------------------- | -------- | ------ |
| 文章列表页   | 从 `/api/articles` 拉取，支持分页     | Java API | P0     |
| 文章详情页   | 动态路由 `/articles/[slug]` 或 `[id]` | Java API | P0     |
| 加载与错误态 | Loading、404、500 友好提示            | -        | P0     |
| 响应式布局   | 移动端适配                            | -        | P0     |

### 3.2 阶段二：增强体验

| 功能         | 说明               | 依赖           | 优先级 |
| ------------ | ------------------ | -------------- | ------ |
| 搜索         | 标题/摘要/标签搜索 | 后端搜索 API   | P1     |
| 分类/标签    | 按分类、标签筛选   | 后端扩展       | P1     |
| RSS 订阅     | 输出 RSS 2.0       | 后端或前端生成 | P1     |
| 评论（可选） | 第三方或自建       | 待定           | P2     |

### 3.3 阶段三：Admin 管理后台（React）

| 功能        | 说明                         | 技术                       | 优先级 |
| ----------- | ---------------------------- | -------------------------- | ------ |
| 登录 / 鉴权 | 对接后端认证                 | React Router、fetch        | P0     |
| 文章列表    | 表格/卡片展示，分页          | -                          | P0     |
| 文章编辑    | **Markdown 编辑** + 实时预览 | react-markdown、CodeMirror | P0     |
| 文章 CRUD   | 创建、更新、删除             | 对接 Java API              | P0     |
| 分类/标签   | 管理分类、标签               | 后端扩展                   | P1     |
| 草稿        | 草稿保存、发布               | -                          | P1     |

### 3.4 阶段四：扩展（可选）

| 应用 | 说明             | 优先级 |
| ---- | ---------------- | ------ |
| `m`  | 移动端 H5 或 PWA | P3     |

---

## 4. 技术决策（待讨论）

### 4.1 路由设计

- **文章详情**：`/articles/[slug]`（SEO 友好）还是 `/articles/[id]`（实现简单）？
- **多语言**：当前 `[locale]/page.tsx`，文章详情是否 `[locale]/articles/[slug]`？

### 4.2 数据获取

- **SSR vs SSG**：列表页用 SSR 还是 ISR？详情页用 SSG 预渲染还是按需 SSR？
- **缓存策略**：`revalidate` 时长、SWR 配置

### 4.3 状态与请求

- **服务端组件优先**：列表、详情是否全部 RSC？
- **客户端交互**：分页、搜索用 `use client` + fetch 还是 Server Action？

### 4.4 测试策略

- **单元测试**：Vitest 还是 Jest？覆盖哪些组件？
- **E2E**：Playwright，关键路径（首页 → 列表 → 详情）
- **覆盖率目标**：80%（参考项目规范）

### 4.5 样式与设计

- **设计系统**：是否引入组件库（如 shadcn/ui）？
- **主题**：仅暗色/亮色，还是支持多主题？

---

## 5. 里程碑

| 里程碑 | 目标                                         | 预计 |
| ------ | -------------------------------------------- | ---- |
| M1     | 文章列表 + 详情可完整浏览（web）             | 待定 |
| M2     | 分页、搜索、错误态完善（web）                | 待定 |
| M3     | Admin 基础：登录 + 文章 CRUD + Markdown 编辑 | 待定 |
| M4     | 测试覆盖 ≥ 80%，CI 通过                      | 待定 |

---

## 6. 已决策

| 决策           | 结论                       |
| -------------- | -------------------------- |
| Admin 技术栈   | React + Vite（非 Next.js） |
| 内容编辑       | Markdown 优先              |
| 学习策略       | AI 辅助完成 → 回头研读学习 |
| Admin 纳入规划 | 是，作为系统学习的一部分   |

---

## 7. 待讨论问题

1. **文章标识**：slug 与 id 的取舍，以及后端 API 是否需调整？
2. **SEO 深度**：是否需要每篇文章独立的 JSON-LD、OG 图片？
3. **性能**：首屏 LCP 目标、图片优化（Next/Image、CDN）？
4. **部署**：Vercel / 自建 / Docker？与现有 `infra/docker` 的关系？

---

## 8. 参考

- [README.md](../README.md) - 项目总览
- [docs/AI_DEVELOPMENT.md](../docs/AI_DEVELOPMENT.md) - AI 协作开发指南
- [AGENTS.md](../AGENTS.md) - 代码规范与快捷指令
